# Інсталяція тестового шлюзу безпечного обміну

___

## Процесс інсталяції

1. [Інсталяція операційної системи](#install-1)
2. [Налаштування мережі](#install-2)
3. [Додавання репозиторія з пакетами СЕВДЕІР](#install-3)
4. [Додавання GPG ключа для репозиторія](#install-4)

### 1. Інсталяція операційної системи {#install-1}

Тестовий шлюз безпечного обміну функціонує на базі операційної системи Ubuntu Server 16.04.5 x64. Інсталяція операційної системи виконується згідно додатку А цієї інструкції.

### 2. Налаштування мережі {#install-2}

Після інсталяції операційної системи необхідно налаштувати мережеві параметри. Рекомендуємо це зробити для всіх компонентів тестового та промислового середовища, згідно спланованих мережевих адрес.

Налаштування IP-адреси в операційній системі Ubuntu Server 16.04 здійснюється у файлі /etc/network/interfaces:

```bash
sudo nano /etc/network/interfaces
```

Приклад налаштувань для статичної IP-адреси має наступний вигляд:

<pre class="pre-file-1">
    auto ens33
    iface ens33 inet static
    address 192.168.1.100
    netmask 255.255.255.0
    gateway 192.168.1.1
    dns-nameservers 192.168.1.1 8.8.8.8
</pre>

- **ens33** - системне ім’я мережевого адаптеру, що налаштовується. Дізнатися його можна за допомогою команди `dmesg | grep eth`,
- **static** - встановлення статичної IP-адреси. У випадку, якщо ви налаштовуєте прив’язку IP-адреси за DHCP, замість static необхідно встановити dhcp і всі інші параметри не налаштовуються,
- **address** - це IP-адреса, яка буде встановлена для цього мережевого адаптера,
- **netmask** - це маска підмережі,
- **gateway** - це IP-адреса основного шлюза,
- **dns-nameservers** - IP-адреси сервері імен, які використовуватимуться для визначення IP-адрес за dns-іменами вузлів мережі.
  
> Конкретні значення у вашому випадку можуть бути іншими.

Крім цього, **якщо віртуальна машина була клонована з метою пришвидшення процесу інсталяції**, необхідно змінити ім’я вузла у наступних файлах: **/etc/hosts** та **/etc/hostname**.

Також потрібно відключити функції автоматичного оновлення пакетів. для цього відкрити файл /etc/apt/apt.conf.d/10periodic за допомогою команди:

```bash
sudo nano /etc/apt/apt.conf.d/10periodic
```

та встановити параметр APT::Periodic::UpdatePackage-Lists у значення 0:

<pre class="pre-file-1">
    APT::Periodic::Update-Packages-Lists "0";
</pre>

Відкрити файл /etc/update-manager/release-upgrades:

```bash
sudo nano /etc/update-manager/release-upgrades
```

та встановити параметр Prompt у значення never:

<pre class="pre-file-1">
    Prompt=never
</pre>

Після збереження змін у файлах, необхідно перезавантажити операційну систему командою:

```bash
sudo shutdown -r now
```

### 3. Додавання репозиторія з пакетами СЕВДЕІР {#install-3}

Підключіться до консолі (командного інтерфейсу) операційної системи шлюзу безпечного обміну, наприклад, за допомогою наступної команди:

> `ssh <ADMIN_USER>@<Your-security-server-IP>`

- `<ADMIN_USER>` - це логін адміністратора безпеки операційної системи шлюзу безпечного обміну, який створено під час інсталяції операційної системи (згідно додатку А до цієї інструкції),
- `<Your-security-server-IP>` - це IP-адреса шлюзу безпечного обміну.

> **Примітка.** Зверніть увагу, що при введенні паролю (password), символи, що ви вводите, не відображаються на екрані - це нормально.

![Вхід на сервер][trembita-test-install-1]

> **Примітка.** При використанні команди sudo перший раз після входу користувача в операційну систему вас запитає пароль цього користувача для підтвердження адміністративних повноважень у системі.

Для додавання репозиторія з пакетами СЕВДЕІР необхідно закоментувати всі рядки у файлі */etc/apt/sources.list* (вставляючи символ # на початку кожного рядку) та додати наступні нові рядки в кінці файлу:

<pre class="pre-file-1">
    deb http://01-03-repo-p-01-n.trembita.gov.ua:82/trembita/ member/
    deb http://02-03-repo-p-02-n.trembita.gov.ua:82/trembita/ member/
</pre>

Швидко це зробити можна за допомогою наступних двох команд. Перша додає символ коментування # до кожного непустого рядку, друга додає новий необхідний рядок з посиланням до репозиторію в кінець файлу.

```bash
sudo sed -i 's/^[A-Za-z0-9]/#&/' /etc/apt/sources.list
echo 'deb http://01-03-repo-p-01-n.trembita.gov.ua:82/trembita/ member/' | sudo tee -a /etc/apt/sources.list
echo 'deb http://02-03-repo-p-02-n.trembita.gov.ua:82/trembita/ member/' | sudo tee -a /etc/apt/sources.list
```

Перевірити результат можна за допомогою текстового редактора nano:

```bash
nano /etc/apt/sources.list
```

![Команди][trembita-test-install-2]

Для виходу з редактору використовується комбінація клавіш “Ctrl + X”. Якщо були внесені зміни, то потрібно натиснути клавішу “Y” для збереження змін, або “N” для відміни.

### 4. Додавання GPG ключа для репозиторія {#install-4}

Для встановлення програмного забезпечення з репозиторію СЕВДЕІР потрібно завантажити та додати в систему GPG ключ репозиторію.

[trembita-test-install-1]: /assets/images/trembita-test-install-1.png  "Logo Title Text 2"
[trembita-test-install-2]: /assets/images/trembita-test-install-2.png  "Logo Title Text 2"
